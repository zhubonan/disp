
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-7.3.4">
    
    
      
        <title>SrTiO3 Ground State - DISP</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.db9e7362.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.3f5d1f46.min.css">
        
          
          
          <meta name="theme-color" content="#ab47bd">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="purple" data-md-color-accent="">
  
    
    <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#searching-for-srtio3-ground-state-structure" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="DISP" class="md-header__button md-logo" aria-label="DISP" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            DISP
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              SrTiO3 Ground State
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/zhubonan/disp/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="DISP" class="md-nav__button md-logo" aria-label="DISP" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    DISP
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/zhubonan/disp/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Getting Started
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Getting Started" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Getting Started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Getting%20Started/installation/" class="md-nav__link">
        Installation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Getting%20Started/remote_computer/" class="md-nav__link">
        Setup for remote computers
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Tutorial
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tutorial" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Tutorial
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../1.1/" class="md-nav__link">
        Lennard-Jones Solid
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../1.04/" class="md-nav__link">
        Lennard-Jones 38 Cluster
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          SrTiO3 Ground State
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        SrTiO3 Ground State
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#search-with-gulp" class="md-nav__link">
    Search with GULP
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#search-with-castep" class="md-nav__link">
    Search with CASTEP
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#high-precision-calculation" class="md-nav__link">
    High precision calculation
  </a>
  
    <nav class="md-nav" aria-label="High precision calculation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#total-resources-usages" class="md-nav__link">
    Total resources usages
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Background
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Background" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Background
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../background/structure_searching/" class="md-nav__link">
        Crystal Structure Prediction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../background/airss/" class="md-nav__link">
        AIRSS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../background/workflow_engine/" class="md-nav__link">
        Workflow Engine
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          How-To
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="How-To" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          How-To
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../How-To/manage_search/" class="md-nav__link">
        Manage Searches
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../How-To/analyse_data/" class="md-nav__link">
        Analyse Data
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          AIRSS Guide
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="AIRSS Guide" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          AIRSS Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../AIRSS%20Guide/introduction/" class="md-nav__link">
        Introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../AIRSS%20Guide/inputs/" class="md-nav__link">
        Inputs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../AIRSS%20Guide/castep_relax/" class="md-nav__link">
        castep_relax
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#search-with-gulp" class="md-nav__link">
    Search with GULP
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#search-with-castep" class="md-nav__link">
    Search with CASTEP
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#high-precision-calculation" class="md-nav__link">
    High precision calculation
  </a>
  
    <nav class="md-nav" aria-label="High precision calculation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#total-resources-usages" class="md-nav__link">
    Total resources usages
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/zhubonan/disp/edit/master/docs/examples/sto/README.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="searching-for-srtio3-ground-state-structure">Searching for SrTiO3 ground state structure</h1>
<p><span class="arithmatex">\(\mathrm{SrTiO_3}\)</span> has a cubic perovskite structure at room temperature with space group <span class="arithmatex">\(Pm\bar{3}m\)</span>.</p>
<h2 id="search-with-gulp">Search with GULP</h2>
<p>In this example we search for its ground state using buckingham potential with long range coulomb interaction with <a href="http://gulp.curtin.edu.au/gulp/">GULP</a>.</p>
<p>The <a href="https://en.wikipedia.org/wiki/Buckingham_potential">Buckingham potential</a> has the form:</p>
<div class="arithmatex">\[ \Phi_{12} = A \exp(-Br) - \frac{C}{r^6} + \frac{q_1 q_2}{4\pi\epsilon_0r} \]</div>
<p>A template seed can be generated with:</p>
<div class="highlight"><pre><span></span><code>gencell 60 1 Sr 1 Ti 1 O 3
</code></pre></div>
<p>The <code>gencell</code> command is a very useful for providing a template <em>seed</em> file for <code>buildcell</code>.
Using the command above, the generated cell has a target volume of 60 <span class="arithmatex">\(\unicode{x212B}^3\)</span> containing one Sr atom, one Ti atom and three O atoms.
The content of this file is shown below.</p>
<details class="example" open="open"><summary>SrTiO3.cell</summary><div class="highlight"><pre><span></span><code>%BLOCK LATTICE_CART
3.914865 0 0
0 3.914865 0
0 0 3.914865
%ENDBLOCK LATTICE_CART

#VARVOL=60

%BLOCK POSITIONS_FRAC
Sr 0.0 0.0 0.0 # Sr1 % NUM=1
Ti 0.0 0.0 0.0 # Ti1 % NUM=1
O 0.0 0.0 0.0 # O1 % NUM=1
O 0.0 0.0 0.0 # O2 % NUM=1
O 0.0 0.0 0.0 # O3 % NUM=1
%ENDBLOCK POSITIONS_FRAC

##SPECIES=Sr,Ti,O
##NATOM=3-9
##FOCUS=3

#SYMMOPS=2-4
##SGRANK=20
#NFORM=2-6
##ADJGEN=0-1
#SLACK=0.25
#OVERLAP=0.1
#MINSEP=1.8-3
#COMPACT
#CELLADAPT
##SYSTEM={Rhom,Tric,Mono,Cubi,Hexa,Orth,Tetra}

KPOINTS_MP_SPACING 0.07

SYMMETRY_GENERATE
SNAP_TO_SYMMETRY

%BLOCK SPECIES_POT
QC5
%ENDBLOCK SPECIES_POT

%BLOCK EXTERNAL_PRESSURE
0 0 0
0 0
0
%ENDBLOCK EXTERNAL_PRESSURE
</code></pre></div>
</details>
<p>An <code>param</code> is also generated for default CASTEP inputs. </p>
<details class="example"><summary>SrTiO3.param</summary><p>A <code>param</code> file CASTEP calculation is generated as well. 
<div class="highlight"><pre><span></span><code>    task                 : geometryoptimization
xc_functional        : PBE
spin_polarized       : false
fix_occupancy        : false
metals_method        : dm
mixing_scheme        : pulay
max_scf_cycles       : 1000
cut_off_energy       : 340 eV
opt_strategy         : speed
page_wvfns           : 0
num_dump_cycles      : 0
backup_interval      : 0
geom_method          : LBFGS
geom_max_iter        : 20
mix_history_length   : 20
finite_basis_corr    : 0
fixed_npw            : true
write_cell_structure : true
write_checkpoint     : none
write_bib            : false
write_otfg           : false
write_cst_esp        : false
write_bands          : false
write_geom           : false
bs_write_eigenvalues : false
calculate_stress     : true
</code></pre></div></p>
</details>
<p>The potential in put for GULP is:</p>
<details class="example" open="open"><summary>SrTiO3.lib for GULP</summary><p>This file <code>SrTiO3.lib</code> is needed for providing the parameters of the interatomic potentials.
<div class="highlight"><pre><span></span><code>species
Sr 2.00
Ti 4.00
O -2.00
lennard 12 6
Sr Sr 1.0 0.0 0. 6.0
Sr Ti 1.0 0.0 0. 6.0
Sr O  2.0 0.0 0. 6.0
Ti Ti 1.0 0.0 0. 6.0
Ti O  2.0 0.0 0. 6.0
O  O  2.0 0.0 0. 6.0
buck
Sr Sr 9949.1  0.2446 0.0 0. 8.0
Sr Ti 12708.1 0.2191 0.0 0. 8.0
Sr O  1805.2  0.3250 0.0 0. 8.0
Ti Ti 16963.1 0.1847 0.0 0. 8.0
Ti O  845.0   0.3770 0.0 0. 8.0
O  O  22746.3 0.1490 0.0 0. 8.0
</code></pre></div></p>
</details>
<p>While this <code>SrTiO3.cell</code> can be used straight away for searching already,
prior knowledge can be used to accelerate the search.
The number of formulas can be altered by setting <code>NFORM=2-6</code> to search for 2-6 formula units,
since it is expected thtat the ground state structure would take more than one formula units.
In addition, the specie-wise minimum separations can be set using the knowledge of known ion sizes and bond lengths - the Ti-O bond is known to be at least 1.8 <span class="arithmatex">\(\unicode{x212B}\)</span> long:</p>
<div class="highlight"><pre><span></span><code>##MINSEP=1.8-3.0
</code></pre></div>
<p>This sets the species-wise minimum separation to be chosen randomly between 1.8 <span class="arithmatex">\(\unicode{x212B}\)</span> to 3.0 <span class="arithmatex">\(\unicode{x212B}\)</span>. </p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>One can invoke more knowledge of the system - cation-cation or anion-anion distances are larger than cation-anion distances. Incorporating this in the structure generation process would further improve the efficiency. </p>
</div>
<p>We can now deploy our search with:</p>
<div class="highlight"><pre><span></span><code>disp deploy search --project example/sto/gulp --seed SrTiO3 --code gulp --num 200 
</code></pre></div>
<p>To run locally</p>
<div class="highlight"><pre><span></span><code>export DISP_DB_FILE=$(pwd)/disp_db.yaml
rlaunch rapidfire 
disp db retrieve-project --project example/sto/gulp
</code></pre></div>
<p>Example output:</p>
<div class="highlight"><pre><span></span><code>cat *.res | cryan -u 0.1 -r -t  
SrTiO3-2*57-e185f4       0.00    61.004    -149.364    3 TiSrO3       Pm-3m          6
SrTiO3-2*37-9915e8       0.00   103.123       0.369    4 TiSrO3       Cmme           1
SrTiO3-2*02-d20277       0.00    85.448       0.399    2 TiSrO3       P21/m          4
SrTiO3-2*57-544bb1       0.00   102.862       0.422    4 TiSrO3       C2/c           1
SrTiO3-2*39-1dddc1       0.00   106.323       0.609    4 TiSrO3       P1             1
SrTiO3-2*05-354449       0.00    84.269       0.621    3 TiSrO3       P2             1
SrTiO3-2*25-1b6445       0.00    68.232       0.710    2 TiSrO3       R-3            3
SrTiO3-2*33-2f8d70       0.00   116.637       0.716    3 TiSrO3       P3212          1
SrTiO3-2*28-308697       0.00   100.410       0.718    4 TiSrO3       P1             1
SrTiO3-2*03-47308a       0.00   101.734       0.726    4 TiSrO3       P1             1
</code></pre></div>
<p>The above commend tries to <em>unite</em> similar structures before ranking them.
The numbers of united structures are printed in the last column.
It can be seen that ground state structure (<span class="arithmatex">\(Pm\bar{3}m\)</span>) has been encountered six times, giving an encounter rate of 3%.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As with all global search methods, there is no guarantee that the ground state is found.
Given a <span class="arithmatex">\(3\%\)</span> encounter rate, the odds of finding the ground state out of 200 trials is:</p>
<div class="arithmatex">\[1 - (0.97)^200 = 99.7 \% \]</div>
<p>Still, one can not rule our that there exists a true ground state with lower encounter rate.
For example, if the encounter rate is 0.1%, the odds of finding it in 200 trials is only <span class="arithmatex">\(18.1\%\)</span>.</p>
</div>
<h2 id="search-with-castep">Search with CASTEP</h2>
<p>Now we use CASTEP to perform the search using the same seed.</p>
<div class="highlight"><pre><span></span><code>disp deploy search --seed SrTiO3  --project example/sto/dft --num 200 --priority 200 --category 24-core
</code></pre></div>
<p>This deploys the search tasks with a higher priority.
The actual calculations should be run on a decent-sized computing cluster.
Here the <code>--category</code> tag set ensures that the job to be picked up by workers whose category is set to <code>24-core</code>.</p>
<p>The command <code>disp db summary --project example/sto/dft</code> can be used to monitor the status of the search.
Once all 200 structures have been completed, retrieve the SHELX files and rank them with <code>ca -r -t</code> as before:</p>
<div class="highlight"><pre><span></span><code>SrTiO3-2*16-fbabe1       0.01    60.788   -3798.971    2 TiSrO3       P4mm           1
SrTiO3-2*13-400370      -0.05    61.009       0.008    2 TiSrO3       R3m            1
SrTiO3-2*39-f3dc32      -0.04    61.073       0.011    3 TiSrO3       R3m            1
SrTiO3-2*49-8bd3e2      -0.03    61.094       0.011    3 TiSrO3       R3m            1
SrTiO3-2*52-9949ce       0.02    83.182       0.092    2 TiSrO3       P21/m          1
SrTiO3-2*30-e8bee6      -0.00    80.260       0.425    4 TiSrO3       Ima2           1
SrTiO3-2*38-7d3a16       0.03    76.714       0.445    4 TiSrO3       C2/c           1
SrTiO3-2*18-ac0857       0.03    72.950       0.466    6 TiSrO3       P32            1
SrTiO3-2*29-c45552      -0.01    74.188       0.498    2 TiSrO3       C2/m           1
SrTiO3-2*07-085d5a      -0.00    95.629       0.576    6 TiSrO3       P-6            1
</code></pre></div>
<p>At the first glance, there is a no structure with space group <span class="arithmatex">\(Pm\bar{3}m\)</span>.
This is not surprise since the <span class="arithmatex">\(Pm\bar{3}m\)</span> phase is not actually the low temperature ground state.
The true ground state has a distorted octahedral network with space group <span class="arithmatex">\(I4/mcm\)</span>.
While we did not found this exact phase, the top four structures are in fact also perovskites but has different distortion patterns.</p>
<p>Note that we have sampled only 200 structures, with the only prior knowledge of estimate range of atom-atom minimum distances and <em>volume per atom</em>.
While continuing the search may allow the true ground state to be found, one can already establish at this point that the ground state of <span class="arithmatex">\(\mathrm{SrTiO_3}\)</span> is a probably a perovskite.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Perovskites are known to have many distorted phases with octahedral.
The P4mm phase obtained is non-central symmetric and has been reported in the literature as well[^1]. 
Using the cubic phases as the high symmetry starting structure, one can also determine the ground state by mode mapping[^2].</p>
</div>
<h2 id="high-precision-calculation">High precision calculation</h2>
<p>Since the DFT search is carried out with setting prioritising speed rather than accuracy, typically one would need to re-relax the obtained structure with more converged parameters and more transferable pseudopotentials.</p>
<p>First, create the <code>SrTiO3-refine.cell</code> and <code>SrTiO3-refine.param</code> with revised parameters:</p>
<div class="admonition example">
<p class="admonition-title">SrTiO3-refine.cell</p>
<div class="highlight"><pre><span></span><code>%BLOCK LATTICE_CART
3.914865 0 0
0 3.914865 0
0 0 3.914865
%ENDBLOCK LATTICE_CART

#VARVOL=60

%BLOCK POSITIONS_FRAC
Sr 0.0 0.0 0.0 # Sr1 % NUM=1
Ti 0.0 0.0 0.0 # Ti1 % NUM=1
O 0.0 0.0 0.0 # O1 % NUM=1
O 0.0 0.0 0.0 # O2 % NUM=1
O 0.0 0.0 0.0 # O3 % NUM=1
%ENDBLOCK POSITIONS_FRAC

KPOINTS_MP_SPACING 0.05

SYMMETRY_GENERATE
SNAP_TO_SYMMETRY

%BLOCK SPECIES_POT
C19
%ENDBLOCK SPECIES_POT

%BLOCK EXTERNAL_PRESSURE
0 0 0
0 0
0
%ENDBLOCK EXTERNAL_PRESSURE
</code></pre></div>
</div>
<p>Where the <code>SPECIES_POT</code> is changed from <code>QC5</code> to <code>C19</code>.
The latter is a library with more accurate pseudopotentials (<a href="https://molmod.ugent.be/deltacodesdft">delta = 0.4 meV</a>).
In addition, the spaces of generated kpoints is requested to be at most <span class="arithmatex">\(0.05 2\pi \unicode{x212B}^{-1}\)</span> for improved sampling of the reciprocal space. </p>
<div class="admonition example">
<p class="admonition-title">SrTiO3-refine.param</p>
<div class="highlight"><pre><span></span><code>task                 : geometryoptimization
xc_functional        : PBE 
spin_polarized       : false 
fix_occupancy        : false 
metals_method        : dm 
mixing_scheme        : pulay 
max_scf_cycles       : 1000 
cut_off_energy       : 700 eV
opt_strategy         : speed 
page_wvfns           : 0 
num_dump_cycles      : 0 
backup_interval      : 0 
geom_method          : LBFGS 
geom_max_iter        : 100 
mix_history_length   : 20 
finite_basis_corr    : auto
fixed_npw            : false
write_cell_structure : true
write_checkpoint     : none
write_bib            : false
write_otfg           : false
write_cst_esp        : false
write_bands          : false
write_geom           : false
bs_write_eigenvalues : false
calculate_stress     : true
</code></pre></div>
</div>
<p>In the <code>param</code> file, the plane-wave cut off energy is raised to <code>700 eV</code>.</p>
<div class="admonition note">
<p class="admonition-title">Constant basis quality relaxation</p>
<p>In this example, the <code>fixed_npw</code> is turned off so the variable cell relaxation will be performed under constant cut-off energy (quality) mode, and <code>finite_basis_corr</code> is turned on to allow the Pulay stress to be correct automatically.
Otherwise, the basis set would change with unit cell, hence the effective cut off energy can be different from that initially supplied.
This means that the final energy is always consistent with the geometry, and there is no need to perform an additional singlepoint calculation as in constant-basis mode, e.g. <code>fixed_npw : true</code>.</p>
</div>
<p>Create a folder with the top structures:</p>
<div class="highlight"><pre><span></span><code>mkdir refine
cp $(ca -r -t -l |  awk &#39;{print $1&quot;.res&quot;}&#39;) refine/
</code></pre></div>
<p>And deploy the relaxations with:</p>
<div class="highlight"><pre><span></span><code>disp deploy relax --seed SrTiO3-refine --base-cell SrTiO3-refine.cell \
--cell &quot;refine/SrTiO3-*.res&quot; --param SrTiO3-refine.param --project example/sto/dft-refine \
--priority 100 --category 24-core --cycles 0
</code></pre></div>
<p>Note that setting <code>cycles</code> to 0 bypass the automatic restart routine in <code>castep_relax</code> which is not needed with constant basis quality mode.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Final results, one may also want to have:
<div class="highlight"><pre><span></span><code>grid_scale : 2
fine_grid_scale : 3
</code></pre></div>
in order to use denser FFT grids.</p>
</div>
<p>The high precision calculations result in a slightly different ranking of energy amount the <span class="arithmatex">\(R3m\)</span> and the <span class="arithmatex">\(P4mm\)</span> phases.
The three <span class="arithmatex">\(R3m\)</span> phases are now having the same energy - they are in fact identical structures.</p>
<div class="highlight"><pre><span></span><code>$ ca -r

SrTiO3-2*39-f3dc32       0.09    61.446   -3798.370    3 TiSrO3       R3m            1
SrTiO3-2*13-400370      -0.02    61.654       0.000    2 TiSrO3       R3m            1
SrTiO3-2*49-8bd3e2       0.05    61.545       0.000    3 TiSrO3       R3m            1
SrTiO3-2*16-fbabe1       0.01    61.490       0.001    2 TiSrO3       P4mm           1
SrTiO3-2*52-9949ce      -0.00    84.050       0.068    2 TiSrO3       P21/m          1
SrTiO3-2*30-e8bee6      -0.04    81.673       0.396    4 TiSrO3       Ima2           1
SrTiO3-2*38-7d3a16      -0.03    77.630       0.425    4 TiSrO3       C2/c           1
SrTiO3-2*18-ac0857       0.06    74.560       0.433    6 TiSrO3       P32            1
SrTiO3-2*29-c45552       0.03    75.529       0.471    2 TiSrO3       C2/m           1
SrTiO3-2*07-085d5a       0.05    97.381       0.551    6 TiSrO3       P-6            1
</code></pre></div>
<h3 id="total-resources-usages">Total resources usages</h3>
<p>The total time that each structure used is recorded in the SHELX file.
In this example, a total of about 7000 core hours have been used.</p>
<div class="highlight"><pre><span></span><code>$ tar -axf sto-res-dft.tar.gz -O | grep  Total | awk &#39;BEGIN{x=0}{x+=$4}END{print x /3600 * 24}&#39;
6945.92
</code></pre></div>
<p>A total of about 7000 core hours has been consumed. 
There are 24 cores per node, so this is equivalent to roughly 12 node days, 
or having 12 such nodes working for a single day.</p>
<p>Savings can be made by running the searches with only 4 cores per <em>worker</em>, and six of such workers can be placed on a node with 24 cores.</p>
<div class="highlight"><pre><span></span><code>$ tar -axf sto-res-dft-4c.tar.gz -O | grep  Total | awk &#39;BEGIN{x=0}{x+=$4}END{print x /3600 * 4 / 189 * 200}&#39;
3893.72
</code></pre></div>
<p>In this case, the estimated time for getting 200 relaxed structure is about 4000 core hours - a 43 % save in the computational resources by replacing 24-way MPI (24 cores) with 4-way MPI (cores) for performing relaxation!
Even with a 10 % uncertainty due to the limited size and stochastic nature of the search, this is still a significant save to make. </p>
<p>Nevertheless, running with more workers each using fewer cores means that each relaxation would take longer time to complete, giving a reduced turn around rate.
This may result in increased time-to-solution for small-scale searching more difficult relaxation can take much longer to finish. 
For a search involving thousands of trials, the optimum strategy is to use low core counts first, and finish off the search with workers with increased cores counts. </p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../1.04/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Lennard-Jones 38 Cluster" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Lennard-Jones 38 Cluster
            </div>
          </div>
        </a>
      
      
        
        <a href="../../background/structure_searching/" class="md-footer__link md-footer__link--next" aria-label="Next: Crystal Structure Prediction" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Crystal Structure Prediction
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.8397ff9e.min.js", "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.1e84347e.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>